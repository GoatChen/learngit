<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.six.dao.ShopIndexMapper">  <!-- 要对应映射接口 -->

	<!-- 根据category_id查询shopGoodsCategory -->
	<resultMap type="shopGoodsCategory" id="selectShopGoodsCategoryMap">
		<id property="id" column="id"/>
		<result property="categoryName" column="categoryName"/>
    	<result property="category_id" column="category_id"/>
    	
    	<result property="createdBy" column="createdBy"/>
    	<result property="creationDate" column="creationDate"/>
    	<result property="modifyBy" column="modifyBy"/>	
    	<result property="modifyDate" column="modifyDate"/>
	</resultMap>
	<select id="selectShopGoodsCategoryByCategoryId" resultMap="selectShopGoodsCategoryMap">
		select * from shop_goodscategory where category_id = #{category_id}
	</select>
	
	<!-- 根据name、category1_id、category1_id、category1_id、currentPageNo、pageSize分页模糊查询shopGoods -->
	<resultMap type="shopGoods" id="selectShopGoodsMap">
		<id property="id" column="id"/>
		<result property="name" column="name"/>
    	<result property="price" column="price"/>
		<result property="score" column="score"/>
    	<result property="size" column="size"/>
		<result property="color" column="color"/>
    	<result property="description" column="description"/>
		<result property="picPath" column="picPath"/>
    	<result property="producerName" column="producerName"/>
    	<result property="produceDate" column="produceDate"/>
    	
    	<result property="createdBy" column="createdBy"/>
    	<result property="creationDate" column="creationDate"/>
    	<result property="modifyBy" column="modifyBy"/>	
    	<result property="modifyDate" column="modifyDate"/>
	</resultMap>
    <select id="selectShopGoods" resultMap="selectShopGoodsMap">  <!-- 分页查询商品列表 -->
    	select * from shop_goods
   		<trim prefix="where" prefixOverrides="and | or">
            <if test="name != null and name != '' ">
              and name like concat('%', #{name}, '%')
            </if>
            <if test="category1_id != null and category1_id != '' ">
              and category1_id = #{category1_id}
            </if>
            <if test="category2_id != null and category2_id != '' ">
              and category2_id = #{category2_id}
            </if>
            <if test="category3_id != null and category3_id != '' ">
              and category3_id = #{category3_id}
            </if>
        </trim>
        limit #{currentPageNo} , #{pageSize};
    </select>
    
    <!-- 得到查询到的所有商品数 -->
    <select id="getShopGoodsCount" resultMap="selectShopGoodsMap">
   		select * from shop_goods
   		<trim prefix="where" prefixOverrides="and | or">
            <if test="name != null and name != '' ">
              and name like concat('%', #{name}, '%')
            </if>
            <if test="category1_id != null and category1_id != '' ">
              and category1_id = #{category1_id}
            </if>
            <if test="category2_id != null and category2_id != '' ">
              and category2_id = #{category2_id}
            </if>
            <if test="category3_id != null and category3_id != '' ">
              and category3_id = #{category3_id}
            </if>
        </trim>
    </select>
    
    
    <!-- 根据id查询ShopGoods -->
    <select id="selectGoodsById" resultType="shopGoods">
    	select * from shop_goods where id=#{id}
    </select>
    
    <!-- 根据id查询卖家 -->
    <select id="selectSellById" resultType="shopSellUser">
    	select * from shop_selluser where id=#{id}
    </select>
    
    <!-- 根据id查询商品ShopGoodsCategory -->
    <select id="selectShopGoodsCategoryById" resultType="shopGoodsCategory">
    	select * from shop_goodscategory where id=#{id}
    </select>
    
    
    <!-- 根据goods_id查询ShopComment列表 -->
	<resultMap type="shopComment" id="selectShopCommentMap">
		<id property="id" column="id"/>
		<result property="content" column="content"/>
    	<result property="score" column="score"/>
		<result property="likeNum" column="likeNum"/>
    	<result property="picPath" column="picPath"/>
    	
		<result property="goods_id" column="goods_id"/>
    	<result property="buy_id" column="buy_id"/>
    	
    	<result property="createdBy" column="createdBy"/>
    	<result property="creationDate" column="creationDate"/>
    	<result property="modifyBy" column="modifyBy"/>	
    	<result property="modifyDate" column="modifyDate"/>
    	
    	<result property="buyCode" column="buyCode"/>
	</resultMap>
	<select id="selectShopCommentById" resultMap="selectShopCommentMap">
		select * from shop_comment where goods_id = #{goods_id}
	</select>
	
    <!-- 根据ShopComment中的buy_id查询ShopBuyUser -->
	<select id="selectShopBuyUserByBuyId" resultType="shopBuyUser">
		select * from shop_buyuser where id = #{goods_id}
	</select>
	
    <!-- 根据buy_id和comment_id查询ShopLike -->
	<select id="selectShopLikeByBuyIdAndCommentId" resultType="ShopLike">
		select * from shop_like where buy_id = #{buy_id} and comment_id = #{comment_id}
	</select>
    
</mapper>