<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.six.dao.backend.ShopCheckMapper">
  
  <resultMap id="ShopGoodsStorageMap" type="com.six.pojo.ShopGoodsStorage">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="price" jdbcType="INTEGER" property="price" />
    <result column="number" jdbcType="INTEGER" property="number" />
    <result column="color" jdbcType="VARCHAR" property="color" />
    <result column="picPath" jdbcType="VARCHAR" property="picPath" />
  </resultMap>

	<!-- 查询待审核商品个数-->
	<select id="getShopCheckCount" resultType="Int">
		select count(*) as count from shop_goodsstorage a
			<trim prefix="where" prefixOverrides="and | or">
				<if test="queryShopName != null and queryShopName != ''">
					and a.name like CONCAT ('%',#{queryShopName},'%')
				</if>
				<if test="status != null">
					and a.status = #{status}
				</if>
				<if test="categoryLevel1 != null">
					and a.category1_id = #{categoryLevel1}
				</if>
				<if test="categoryLevel2 != null">
					and a.category2_id = #{categoryLevel2}
				</if>
				<if test="categoryLevel3 != null">
					and a.category3_id = #{categoryLevel3}
				</if>
			</trim>
	</select>
	
	<!-- 查询待审核商品列表-->
	<select id="getShopCheckList" resultMap="ShopGoodsStorageMap">
		select a.id, a.name,a.price,a.number,a.size,a.color,a.picPath,a.sell_id,a.status,a.creationDate,
				a.category1_id,
				(select categoryName from shop_goodscategory c where  c.id=a.category1_id) as categoryName1,
				a.category2_id,
				(select categoryName from shop_goodscategory c where  c.id=a.category2_id) as categoryName2,
				a.category3_id,
				(select categoryName from shop_goodscategory c where  c.id=a.category3_id) as categoryName3
			from  shop_goodsstorage a
		<trim prefix="where" prefixOverrides="and | or">
			<if test="queryShopName != null and queryShopName != ''">
				and a.name like concat('%',#{queryShopName},'%')
			</if>
			<if test="status != null">
				and a.status = #{status}
			</if>
			<if test="categoryLevel1 != null">
				and a.category1_id = #{categoryLevel1}
			</if>
			<if test="categoryLevel2 != null">
				and a.category2_id = #{categoryLevel2}
			</if>
			<if test="categoryLevel3 != null">
				and a.category3_id = #{categoryLevel3}
			</if>
		</trim>
		order by creationDate DESC limit #{from},#{pageSize}
	</select>
	
	<!-- 查询单个待审核商品列表-->
	<select id="getShopInfo" resultType="com.six.pojo.ShopGoodsStorage">
		select a.id, a.name,a.price,a.number,a.size,a.color,a.picPath,a.sell_id,a.status,a.creationDate,
				a.category1_id,
				(select categoryName from shop_goodscategory c where  c.id=a.category1_id) as categoryName1,
				a.category2_id,
				(select categoryName from shop_goodscategory c where  c.id=a.category2_id) as categoryName2,
				a.category3_id,
				(select categoryName from shop_goodscategory c where  c.id=a.category3_id) as categoryName3
			from  shop_goodsstorage a
		<trim prefix="where" prefixOverrides="and | or">
			<if test="id != null">
				and a.id = #{id}
			</if>
		</trim>
	</select>
	
	<update id="updateSatus" parameterType="Integer">
		update shop_goodsstorage 
			set status = #{status}
			where id = #{id}
	</update>
	
</mapper>